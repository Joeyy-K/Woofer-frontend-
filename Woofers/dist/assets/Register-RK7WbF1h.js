import{r as o,u as T,A as U,U as B,j as e,L as E,a as I,b as x}from"./index-w1UzHfgm.js";import{Q as W,B as f}from"./ReactToastify-SnbspBe0.js";function Z(l){let d=null;if(document.cookie&&document.cookie!==""){let i=document.cookie.split(";");for(let c=0;c<i.length;c++){let a=i[c].trim();if(a.substring(0,l.length+1)===l+"="){d=decodeURIComponent(a.substring(l.length+1));break}}}return d}const F=()=>{const[l,d]=o.useState(""),[i,c]=o.useState(""),[a,g]=o.useState(""),[O,b]=o.useState(""),[w,s]=o.useState(""),C=T(),{setIsAuthenticated:j}=o.useContext(U),{setUser:v}=o.useContext(B),[k,n]=o.useState(!1),[u,N]=o.useState(!1),[m,y]=o.useState(!1),[p,P]=o.useState("");let L=Z("csrftoken");const S=l&&i&&a,M=t=>/^(?=.*\d)(?=.*[a-zA-Z]).{8,}$/.test(t),q=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),A=t=>{t.preventDefault(),N(!u)},z=t=>{t.preventDefault(),y(!m)},R=()=>{if(!S){f.error("Please fill in all fields!"),s("Please fill in all fields");return}if(!M(a)){s("Password must have at least 8 characters and at least one digit");return}if(!q(i)){s("Please enter a valid email address");return}if(a!==p){s("Passwords do not match");return}n(!0),new Promise((t,r)=>{fetch(`${I}/user/register/`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":L},body:JSON.stringify({username:l,email:i,password:a}),credentials:"include"}).then(h=>{setTimeout(()=>t(h),2e3)}).catch(h=>{setTimeout(()=>r(h),2e3)})}).then(t=>{if(t.ok)return t.json().then(r=>{b("Registration successful!"),d(""),c(""),g(""),s(""),f.success("Successfully registered!"),j(!0),v(r.user),x.set("isAuthenticated","true"),x.set("user",JSON.stringify(r.user)),x.set("userToken",r.token),C("/")});if(t.status===400)return t.json().then(r=>{f.error("Please fill in all the fields!"),n(!1),s(r.error)});if(t.status===403)n(!1),s("You do not have permission to perform this action");else if(t.status===404)n(!1),s("The requested resource could not be found");else{if(t.status===409)return t.json().then(r=>{n(!1),s(r.message)});t.status===500?(n(!1),s("An error occurred on the server")):(n(!1),s("An error occurred during registration"))}}).catch(t=>{n(!1),console.error("Registration error:",t),s("An error occurred during registration")})};return e.jsxs("div",{className:"max-w-md sm:w-420 flex-center flex-col mx-auto",children:[e.jsx("div",{className:"items-center justify-center",children:e.jsx(W,{})}),e.jsx("h1",{className:"text-2xl font-bold mb-5 sm:pt-12",children:"Create a new account"}),k&&e.jsxs("button",{type:"button",className:"py-2 px-4 flex justify-center items-center bg-blue-600 hover:bg-blue-700 focus:ring-blue-500 focus:ring-offset-blue-200 text-white w-full transition ease-in duration-200 text-center text-base font-semibold shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2  rounded-lg max-w-md",children:[e.jsx("svg",{width:"20",height:"20",fill:"currentColor",className:"mr-2 animate-spin",viewBox:"0 0 1792 1792",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M526 1394q0 53-37.5 90.5t-90.5 37.5q-52 0-90-38t-38-90q0-53 37.5-90.5t90.5-37.5 90.5 37.5 37.5 90.5zm498 206q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zm-704-704q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zm1202 498q0 52-38 90t-90 38q-53 0-90.5-37.5t-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zm-964-996q0 66-47 113t-113 47-113-47-47-113 47-113 113-47 113 47 47 113zm1170 498q0 53-37.5 90.5t-90.5 37.5-90.5-37.5-37.5-90.5 37.5-90.5 90.5-37.5 90.5 37.5 37.5 90.5zm-640-704q0 80-56 136t-136 56-136-56-56-136 56-136 136-56 136 56 56 136zm530 206q0 93-66 158.5t-158 65.5q-93 0-158.5-65.5t-65.5-158.5q0-92 65.5-158t158.5-66q92 0 158 66t66 158z"})}),"loading"]}),w&&e.jsxs("div",{className:"bg-red-200 px-4 py-2 my-4 rounded-md text-lg flex items-center mx-auto max-w-lg",children:[e.jsx("svg",{viewBox:"0 0 24 24",className:"text-red-600 w-5 h-5 sm:w-5 sm:h-5 mr-3",children:e.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})}),e.jsxs("span",{className:"text-red-800",children:[" ",w]})]}),e.jsxs("form",{children:[e.jsx("label",{className:"block mb-2 font-extrabold",children:"Username"}),e.jsx("input",{autoComplete:"username",type:"text",placeholder:"Username",value:l,onChange:t=>d(t.target.value),className:"border border-gray-300 p-2 mt-4 mb-3 w-full block"}),e.jsx("label",{className:"block mb-2 font-extrabold",children:"Email"}),e.jsx("input",{autoComplete:"email",type:"email",placeholder:"Email",value:i,onChange:t=>c(t.target.value),className:"border border-gray-300 p-2 mt-4 mb-3 w-full block"}),e.jsx("label",{className:"block mb-2 font-extrabold",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{autoComplete:"new-password",type:u?"text":"password",value:a,onChange:t=>g(t.target.value),className:"border border-gray-300 mb-3 px-4 py-2 mt-3 w-full block"}),e.jsx("button",{onClick:A,className:"absolute inset-y-0 right-0 pl-3 pr-3 flex items-center",children:u?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M2.99902 3L20.999 21M9.8433 9.91364C9.32066 10.4536 8.99902 11.1892 8.99902 12C8.99902 13.6569 10.3422 15 11.999 15C12.8215 15 13.5667 14.669 14.1086 14.133M6.49902 6.64715C4.59972 7.90034 3.15305 9.78394 2.45703 12C3.73128 16.0571 7.52159 19 11.9992 19C13.9881 19 15.8414 18.4194 17.3988 17.4184M10.999 5.04939C11.328 5.01673 11.6617 5 11.9992 5C16.4769 5 20.2672 7.94291 21.5414 12C21.2607 12.894 20.8577 13.7338 20.3522 14.5",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-5 h-5",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),e.jsx("label",{className:"block mb-2 font-extrabold",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{autoComplete:"new-password",type:m?"text":"password",value:p,onChange:t=>P(t.target.value),className:"border border-gray-300 mb-3 px-4 py-2 mt-3 w-full block"}),e.jsx("button",{onClick:z,className:"absolute inset-y-0 right-0 pl-3 pr-3 flex items-center",children:m?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M2.99902 3L20.999 21M9.8433 9.91364C9.32066 10.4536 8.99902 11.1892 8.99902 12C8.99902 13.6569 10.3422 15 11.999 15C12.8215 15 13.5667 14.669 14.1086 14.133M6.49902 6.64715C4.59972 7.90034 3.15305 9.78394 2.45703 12C3.73128 16.0571 7.52159 19 11.9992 19C13.9881 19 15.8414 18.4194 17.3988 17.4184M10.999 5.04939C11.328 5.01673 11.6617 5 11.9992 5C16.4769 5 20.2672 7.94291 21.5414 12C21.2607 12.894 20.8577 13.7338 20.3522 14.5",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-5 h-5",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),e.jsx("button",{onClick:R,className:"bg-blue-500 text-white mt-4  w-full py-2 rounded-md",children:"Register"}),e.jsxs("p",{className:"p-4 text-center font-extrabold",children:["Already have an account? ",e.jsx(E,{to:"/",className:"text-red-500 hover:underline",children:"Sign in here"})]})]})};export{F as default};
